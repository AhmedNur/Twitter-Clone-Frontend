{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/tweet.service\";\nimport * as i2 from \"../services/authentication.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../tweet/tweet.component\";\n\nfunction TimelineComponent_li_1_app_tweet_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-tweet\", 4);\n  }\n\n  if (rf & 2) {\n    const tweet_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"tweet\", tweet_r2);\n  }\n}\n\nfunction TimelineComponent_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 2);\n    i0.ɵɵtemplate(1, TimelineComponent_li_1_app_tweet_1_Template, 1, 1, \"app-tweet\", 3);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.tag || ctx_r0.tag == ctx_r0.auth.userDetails.getValue().tag);\n  }\n}\n\nfunction TimelineComponent_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 2);\n    i0.ɵɵelement(1, \"app-tweet\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const tweet_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"tweet\", tweet_r5);\n  }\n}\n\nexport let TimelineComponent = /*#__PURE__*/(() => {\n  class TimelineComponent {\n    constructor(tweetService, auth) {\n      this.tweetService = tweetService;\n      this.auth = auth;\n    }\n\n    ngOnInit() {\n      this.scrollDebounce = true;\n      this.page = 0;\n\n      if (this.tag == undefined && this.tweets == undefined) {\n        this.tweetService.getHome(this.page).subscribe(tweets => {\n          this.tweets = tweets;\n        });\n      } else if (this.tweets == undefined) {\n        this.tweetService.getTweetsByAuthor(this.tag, this.page).subscribe(tweets => {\n          this.tweets = tweets;\n        });\n      }\n\n      this.tweetService.newTweets = [];\n      this.tweetService.getNewTweets().subscribe(newTweets => {\n        this.newTweets = newTweets;\n      });\n    }\n\n    onScrollEvent($event) {\n      let timeline = document.getElementById('timeline');\n\n      if (window.scrollY > timeline.offsetHeight + timeline.offsetTop - 1000) {\n        if (this.scrollDebounce) {\n          this.scrollDebounce = false;\n          this.page++;\n\n          if (this.tag == undefined) {\n            this.tweetService.getHome(this.page).subscribe(tweets => {\n              this.tweets = this.tweets.concat(tweets);\n            });\n          } else {\n            this.tweetService.getTweetsByAuthor(this.tag, this.page).subscribe(tweets => {\n              this.tweets = this.tweets.concat(tweets);\n            });\n          }\n\n          setTimeout(function () {\n            this.scrollDebounce = true;\n          }.bind(this), 500);\n        }\n      }\n    }\n\n  }\n\n  TimelineComponent.ɵfac = function TimelineComponent_Factory(t) {\n    return new (t || TimelineComponent)(i0.ɵɵdirectiveInject(i1.TweetService), i0.ɵɵdirectiveInject(i2.AuthenticationService));\n  };\n\n  TimelineComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TimelineComponent,\n    selectors: [[\"app-timeline\"]],\n    hostBindings: function TimelineComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"scroll\", function TimelineComponent_scroll_HostBindingHandler($event) {\n          return ctx.onScrollEvent($event);\n        }, false, i0.ɵɵresolveWindow);\n      }\n    },\n    inputs: {\n      tag: \"tag\",\n      tweets: \"tweets\"\n    },\n    decls: 3,\n    vars: 2,\n    consts: [[\"id\", \"timeline\"], [\"class\", \"timeline-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"timeline-item\"], [3, \"tweet\", 4, \"ngIf\"], [3, \"tweet\"]],\n    template: function TimelineComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ul\", 0);\n        i0.ɵɵtemplate(1, TimelineComponent_li_1_Template, 2, 1, \"li\", 1);\n        i0.ɵɵtemplate(2, TimelineComponent_li_2_Template, 2, 1, \"li\", 1);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.newTweets);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.tweets);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.TweetComponent],\n    styles: [\"#timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0;margin:0;width:100%}.timeline-item[_ngcontent-%COMP%]{list-style:none}\"]\n  });\n  return TimelineComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}